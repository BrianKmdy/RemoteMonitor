<html>
    <body>
        <canvas id="video" width="1920" height="1080"">
        Your browser does not support the HTML5 canvas tag.
        </canvas>

        <script type="module">
            // Create WebSocket connection.
            const socket = new WebSocket('ws://' + window.location.hostname + ':5001');

            // Connection opened
            socket.addEventListener('open', function (event) {
                socket.send('Hello Server!');
            });

            socket.onmessage = function(e) {
                var server_message = e.data;
                console.log(server_message);
            }


            let canvas = document.getElementById('video')
            let ctx = canvas.getContext('2d');

            async function draw(imageBytes){
                var base64 = btoa(new Uint8Array(imageBytes).reduce((data, byte) => data + String.fromCharCode(byte), ''));
                var image = new Image();
                image.src = "data:image/jpeg;base64," + base64;
                image.onload = () => {
                    ctx.imageSmoothingEnabled = false;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(image, 0, 0, 1920, 1080);
                };
            }
        </script>
    </body>
</html>
